{
  "hash": "603336689874db247f1e01ad85d9b0c8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Downloadable Reports\"\nsubtitle: \"A deep dive into Shiny reports\"\nauthor: \"Martin Frigaard\"\ndate: \"2025-08-02\"\ncategories: [Quarto, Shiny, RMarkdown]\nimage: \"img/image.png\"\ntoc: true\ntoc-depth: 5\ntoc-title: 'Contents'\ntoc-location: \"left\"\n# code-block-border-left: true\ncode-block-bg: \"#f8f8f8\"\ncode-block-border-left: \"#e8e8e8\"\ncode-fold: show\ncode-summary: 'show/hide'\ncallout-icon: false\n\ndraft: true\n\nfreeze: true\n\nknitr:\n  opts_chunk: \n    fig-dpi: 320\n    fig-width: 6\n    out-width: '85%'\n    fig-format: png\n    fig-align: 'center'\n\nexecute:\n  echo: true\n  message: false\n  warning: false\n  eval: false\n---\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::: {.callout-important collapse='false' appearance='default' icon=false}\n\n## [DRAFT!]{style='font-weight: bold; font-size: 1.15em;'}\n\n::: {style='font-size: 1.10em; color: #282b2d;'}\n\n\nThis post is currently under development--thank you for your patience.\n\n::: \n\n::::\n:::\n\n\nThis post covers parameterized reports in Shiny applications (via R Markdown and/or Quarto). Downloadable reports are a great feature to include in your application, and I've put together some tips I've learned by adding this feature to multiple applications. \n\n## ttdviewer\n\nTo help demonstrate a variety of report options, I've written the [`ttdviewer` R  package](https://mjfrigaard.github.io/ttdviewer/index.html), which contains a Shiny application with a variety outputs to include downloadable reports.[^tidytues]\n\n[^tidytues]: `load_tt_data()` joins the metadata from [`ttmeta`](https://r4ds.github.io/ttmeta/) and [`tidytuesdayR`](https://dslc-io.github.io/tidytuesdayR/).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(ttdviewer)\n```\n:::\n\n\nI've displayed the R folder for `ttdviewer` below. The package includes a \nhandful of modules and utility functions, UI and server functions, and a standalone app function. \n\n\n```{.default}\nR/\n├── app_server.R #<1>\n├── app_ui.R #<1>\n├── inspect_plot.R #<3>\n├── launch.R #<4>\n├── load_tt_data.R #<2>\n├── logr_msg.R #<5>\n├── mod_list.R #<6>\n├── mod_report_desc.R #<6>\n├── mod_report_download.R #<6>\n├── mod_report_input.R #<6>\n├── mod_table.R #<6>\n├── mod_input.R #<6>\n├── mod_viz.R #<6>\n├── render_report.R # <7>\n└── testthat.R # <8>\n\n1 directory, 15 files\n```\n1. App functions \n2. Data utility function   \n3. Plot utility function   \n4. Standalone app function \n5. Logging function \n6. Shiny modules  \n7. Report utilities  \n8. Test utilities \n\nBelow is an abstract syntax tree[^ast] of the dataset and report format input modules, and the list, table, and graph output modules. \n\n\n\n[^ast]: Compliments of the [`lobstr::ast()`](https://lobstr.r-lib.org/reference/ast.html) function.\n\nIn the sections below, we'll cover how to the inputs are passed between the modules before being rendered in the downloaded report.\n\n## #TidyTuesday data\n\n![Download progress for #tidytuesday data](img/mod_input.png){width='50%' fig-align='center'}\n\nThe sidebar has a single input that allows users to select a dataset from the [#TidyTuesday project.](https://github.com/rfordatascience/tidytuesday) The dataset title (`input$ds_title`) is collected in `mod_input_ui()` and passed to `mod_input_server()`, where it's used to create and return the reactive input for the remaining modules in the application. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nchoices <- unique(all_tt_combined$title) # <1> \nselectInput( # <2>\n  inputId = ns(\"ds_title\"),\n  label = strong(\"Choose Dataset Title:\"),\n  choices = choices,\n  selected = \"Space Launches\"\n) # <2>\n```\n:::\n\n1. Dataset titles from the internal `all_tt_combined` data    \n2. User input   \n\nThe title is used to create the reactive expression `data()`  with `load_tt_data()`. \n\n:::{.column-margin}\n\n[`logr_msg()`](https://github.com/mjfrigaard/ttdviewer/blob/main/R/logr_msg.R) is a custom logging function using the [`logger` package](https://daroczig.github.io/logger/). \n\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\ndata <- reactive({ \n  req(input$ds_title)\n  logr_msg(\n    message = paste(\"User selected dataset:\", input$ds_title),\n    level = \"INFO\"\n    )\n  tryCatch({\n      result <- load_tt_data(input$ds_title) # <1> \n      if (length(result) == 0) {\n        logr_msg(\n          message = \"Empty dataset returned\",\n          level = \"WARN\")\n        showNotification(\"No data available for selected dataset\", # <2> \n          type = \"warning\", duration = 5\n        ) # <2> \n      } else {\n        logr_msg(\n          message = \"Dataset successfully loaded in reactive\",\n          level = \"SUCCESS\"\n          )\n      }\n      return(result)\n    },\n    error = function(e) { # <3>\n      logr_msg(\n        message = paste(\"Error in data reactive:\", e$message),\n        level = \"ERROR\"\n        )\n      showNotification(paste(\"Error loading data:\", e$message),\n        type = \"error\", duration = 10\n      )\n      return(list())\n    }) # <3>\n}) |>\n  bindEvent(input$ds_title) \n```\n:::\n\n1. Reactive `data()` list is created from [`load_tt_data()` function](https://github.com/mjfrigaard/ttdviewer/blob/main/R/load_tt_data.R).      \n2. Notification for unavailable data    \n3. Graceful error handling    \n\nThe download progress is displayed with `details()` and `summary()` tags. \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\ntags$details(\n  tags$summary(\n    em(\"View download details:\")\n  ),\n  verbatimTextOutput(ns(\"vals\"))\n)\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\noutput$vals <- renderPrint({ \n  req(data())\n  ds_names <- names(data())\n  cat(\n    paste(\"Downloaded\", ds_names, \"data.\",\n      collapse = \"\\n\"\n    )\n  )\n}) \n```\n:::\n\n\nThe `load_tt_data()` function can be used to import the data into the app. A demo of this function is below:\n\n:::{.column-margin}\n\n*`ttd` is a named list with however many datasets the title refers to.*\n\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nttd <- load_tt_data(\"Space Launches\")\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"show/hide ttd structure\"}\nstr(ttd)\n# List of 2\n#  $ agencies.csv: spc_tbl_ [74 × 19] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n#   ..$ agency            : chr [1:74] \"RVSN\" \"UNKS\" \"NASA\" \"USAF\" ...\n#   ..$ count             : num [1:74] 1528 904 469 388 258 ...\n#   ..$ ucode             : chr [1:74] \"RVSN\" \"GUKOS\" \"NASA\" \"USAF\" ...\n#   ..$ state_code        : chr [1:74] \"SU\" \"SU\" \"US\" \"US\" ...\n#   ..$ type              : chr [1:74] \"O/LA\" \"O/LA\" \"O/LA/LV/PL/S\" \"O/LA/S\" ...\n#   ..$ class             : chr [1:74] \"D\" \"D\" \"C\" \"D\" ...\n#   ..$ tstart            : chr [1:74] \"1960\" \"1986 Apr 24\" \"1958 Oct  1\" \"1947 Sep 18\" ...\n#   ..$ tstop             : chr [1:74] \"1991 Dec\" \"1991\" \"-\" \"-\" ...\n#   ..$ short_name        : chr [1:74] \"RVSN\" \"UNKS\" \"NASA\" \"USAF\" ...\n#   ..$ name              : chr [1:74] \"Rakentiye Voiska Strategicheskogo Naznacheniye\" \"Upravleniye Nachalnika Kosmicheskikh Sredstv\" \"National Aeronautics and Space Administration\" \"United States Air Force\" ...\n#   ..$ location          : chr [1:74] \"Mosvka?\" \"Moskva\" \"Washington, D.C.\" \"Washington, DC-Pentagon\" ...\n#   ..$ longitude         : chr [1:74] \"-\" \"-\" \"-\" \"-\" ...\n#   ..$ latitude          : chr [1:74] \"-\" \"-\" \"-\" \"-\" ...\n#   ..$ error             : chr [1:74] \"-\" \"-\" \"-\" \"-\" ...\n#   ..$ parent            : chr [1:74] \"-\" \"MO\" \"-\" \"-\" ...\n#   ..$ short_english_name: chr [1:74] \"-\" \"-\" \"-\" \"-\" ...\n#   ..$ english_name      : chr [1:74] \"Strategic Rocket Forces\" \"-\" \"-\" \"-\" ...\n#   ..$ unicode_name      : chr [1:74] \"Ракетные войска стратегического назначения\" \"Управление начальника космических средств МО СССР\" \"National Aeronautics and Space Administration\" \"United States Air Force\" ...\n#   ..$ agency_type       : chr [1:74] \"state\" \"state\" \"state\" \"state\" ...\n#   ..- attr(*, \"spec\")=\n#   .. .. cols(\n#   .. ..   agency = col_character(),\n#   .. ..   count = col_double(),\n#   .. ..   ucode = col_character(),\n#   .. ..   state_code = col_character(),\n#   .. ..   type = col_character(),\n#   .. ..   class = col_character(),\n#   .. ..   tstart = col_character(),\n#   .. ..   tstop = col_character(),\n#   .. ..   short_name = col_character(),\n#   .. ..   name = col_character(),\n#   .. ..   location = col_character(),\n#   .. ..   longitude = col_character(),\n#   .. ..   latitude = col_character(),\n#   .. ..   error = col_character(),\n#   .. ..   parent = col_character(),\n#   .. ..   short_english_name = col_character(),\n#   .. ..   english_name = col_character(),\n#   .. ..   unicode_name = col_character(),\n#   .. ..   agency_type = col_character(),\n#   .. ..   .delim = \",\"\n#   .. .. )\n#   ..- attr(*, \"problems\")=<externalptr> \n#   ..- attr(*, \"clean_title\")= chr \"space_launches\"\n#  $ launches.csv: spc_tbl_ [5,726 × 11] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n#   ..$ tag        : chr [1:5726] \"1967-065\" \"1967-080\" \"1967-096\" \"1968-042\" ...\n#   ..$ JD         : num [1:5726] 2439671 2439726 2439775 2440000 2440153 ...\n#   ..$ launch_date: Date[1:5726], format:  ...\n#   ..$ launch_year: num [1:5726] 1967 1967 1967 1968 1968 ...\n#   ..$ type       : chr [1:5726] \"Thor Burner 2\" \"Thor Burner 2\" \"Thor Burner 2\" \"Thor Burner 2\" ...\n#   ..$ variant    : chr [1:5726] NA NA NA NA ...\n#   ..$ mission    : chr [1:5726] \"Secor Type II S/N 10\" \"DAPP 3419\" \"DAPP 4417\" \"DAPP 5420\" ...\n#   ..$ agency     : chr [1:5726] \"US\" \"US\" \"US\" \"US\" ...\n#   ..$ state_code : chr [1:5726] \"US\" \"US\" \"US\" \"US\" ...\n#   ..$ category   : chr [1:5726] \"O\" \"O\" \"O\" \"O\" ...\n#   ..$ agency_type: chr [1:5726] \"state\" \"state\" \"state\" \"state\" ...\n#   ..- attr(*, \"spec\")=\n#   .. .. cols(\n#   .. ..   tag = col_character(),\n#   .. ..   JD = col_double(),\n#   .. ..   launch_date = col_date(format = \"\"),\n#   .. ..   launch_year = col_double(),\n#   .. ..   type = col_character(),\n#   .. ..   variant = col_character(),\n#   .. ..   mission = col_character(),\n#   .. ..   agency = col_character(),\n#   .. ..   state_code = col_character(),\n#   .. ..   category = col_character(),\n#   .. ..   agency_type = col_character(),\n#   .. ..   .delim = \",\"\n#   .. .. )\n#   ..- attr(*, \"problems\")=<externalptr> \n#   ..- attr(*, \"clean_title\")= chr \"space_launches\"\n```\n:::\n\n\n## List display\n\n![List view of selected #tidytuesday data](img/listviewerlite.png)\n\nOn the first tab, the selected data is displayed using the  [`listviewerlite` package](https://long39ng.github.io/listviewerlite/) and the `mod_list` module. \n\n\n::: {.cell layout-align=\"center\"}\n\n```\n█─launch_app \n├─█─app_ui \n│ ├─█─mod_input_ui \n│ └─█─mod_list_ui \n└─█─app_server \n  ├─█─mod_input_server \n  │ └─█─load_tt_data \n  └─█─mod_list_server \n```\n:::\n\n\n\nThe `mod_list` module includes help text and graceful error handling with a clear message if the UI fails:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\n  tryCatch({\n      bslib::card(\n        bslib::card_body(\n          markdown(\"Below is a preview of the [#TidyTuesday](https://github.com/rfordatascience/tidytuesday) \n            dataset(s) provided by [`listviewerlite`](https://long39ng.github.io/listviewerlite/)\"),\n          uiOutput(ns(\"list\"))\n        )\n      )\n    },\n    error = function(e) {\n      logr_msg(\n        message = paste(\"Error creating list UI:\", e$message),\n        level = \"ERROR\")\n      bslib::card(\n        bslib::card_header(\"List Error\"),\n        bslib::card_body(\n          h4(\"Error loading list interface\", class = \"text-danger\")\n        )\n      )\n    })\n```\n:::\n\n\n\nThe output is rendered with a `renderUI()` and displays the reactive `data()` list:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\noutput$list <- renderUI({\n  req(data())\n  listviewerlite::listview(data())\n})\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nlistviewerlite::listview(ttd)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<ul class=\"tree\">\n<li>\n<details open=\"true\">\n<summary>\n<span>\n<code class=\"vec-header\">&lt;named list [1:2]&gt;</code>\n</span>\n</summary>\n<ul>\n<li>\n<details>\n<summary>\n<span>\nagencies.csv\n<code class=\"vec-header\">&lt;named list [1:19]&gt;</code>\n</span>\n</summary>\n<ul>\n<li>\n<span>\nagency\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"RVSN\", \"UNKS\", \"NASA\", \"USAF\", \"AE\", \"AFSC\", \"VKSR\", \"CALT\", …</span>\n</li>\n<li>\n<span>\ncount\n<code class=\"vec-header\">&lt;double [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">1528, 904, 469, 388, 258, 247, 200, 181, …</span>\n</li>\n<li>\n<span>\nucode\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"RVSN\", \"GUKOS\", \"NASA\", \"USAF\", \"AE\", \"AFSC\", \"GUKOS\", \"CALT\", …</span>\n</li>\n<li>\n<span>\nstate_code\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"SU\", \"SU\", \"US\", \"US\", \"F\", \"US\", \"RU\", \"CN\", …</span>\n</li>\n<li>\n<span>\ntype\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"O/LA\", \"O/LA\", \"O/LA/LV/PL/S\", \"O/LA/S\", \"O/LA\", \"LA\", \"O/LA\", \"LA/LV/PL/E\", …</span>\n</li>\n<li>\n<span>\nclass\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"D\", \"D\", \"C\", \"D\", \"B\", \"D\", \"D\", \"C\", …</span>\n</li>\n<li>\n<span>\ntstart\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"1960\", \"1986 Apr 24\", \"1958 Oct  1\", \"1947 Sep 18\", \"1980 Mar 26\", \"1961 Apr  1\", \"1997 Jul\", \"1957 Nov 11\", …</span>\n</li>\n<li>\n<span>\ntstop\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"1991 Dec\", \"1991\", \"-\", \"-\", \"*\", \"1992 Jul  1\", \"2001 Jun  1\", \"-\", …</span>\n</li>\n<li>\n<span>\nshort_name\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"RVSN\", \"UNKS\", \"NASA\", \"USAF\", \"Arianespace\", \"AFSC\", \"VKS RVSN\", \"CALT\", …</span>\n</li>\n<li>\n<span>\nname\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"Rakentiye Voisk…\", \"Upravleniye Nac…\", \"National Aerona…\", \"United States A…\", \"Arianespace, In…\", \"US Air Force Sy…\", \"Voenno-Kosmiche…\", \"Zhongguo yunzai…\", …</span>\n</li>\n<li>\n<span>\nlocation\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"Mosvka?\", \"Moskva\", \"Washington, D.C.\", \"Washington, DC-…\", \"Paris-Evry, Fra…\", \"El Segundo, Cal…\", \"Mosvka-Solnechn…\", \"Beijing-Nanyuan\", …</span>\n</li>\n<li>\n<span>\nlongitude\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"-\", \"-\", \"-\", \"-\", \"-\", \"-\", \"-\", \"-\", …</span>\n</li>\n<li>\n<span>\nlatitude\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"-\", \"-\", \"-\", \"-\", \"-\", \"-\", \"-\", \"-\", …</span>\n</li>\n<li>\n<span>\nerror\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"-\", \"-\", \"-\", \"-\", \"-\", \"-\", \"-\", \"-\", …</span>\n</li>\n<li>\n<span>\nparent\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"-\", \"MO\", \"-\", \"-\", \"-\", \"USAF\", \"RVSN\", \"CASC\", …</span>\n</li>\n<li>\n<span>\nshort_english_name\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"-\", \"-\", \"-\", \"-\", \"Arianespace\", \"-\", \"-\", \"CALT\", …</span>\n</li>\n<li>\n<span>\nenglish_name\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"Strategic Rocke…\", \"-\", \"-\", \"-\", \"-\", \"-\", \"Russian Militar…\", \"Chinese Academy…\", …</span>\n</li>\n<li>\n<span>\nunicode_name\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"Ракетные войска…\", \"Управление нача…\", \"National Aerona…\", \"United States A…\", \"Arianespace, In…\", \"US Air Force Sy…\", \"Военно-космичес…\", \"中国运载火箭技术研究院\", …</span>\n</li>\n<li>\n<span>\nagency_type\n<code class=\"vec-header\">&lt;character [1:74]&gt;</code>\n</span>\n<span class=\"vec-data\">\"state\", \"state\", \"state\", \"state\", \"private\", \"state\", \"state\", \"state\", …</span>\n</li>\n</ul>\n</details>\n</li>\n<li>\n<details>\n<summary>\n<span>\nlaunches.csv\n<code class=\"vec-header\">&lt;named list [1:11]&gt;</code>\n</span>\n</summary>\n<ul>\n<li>\n<span>\ntag\n<code class=\"vec-header\">&lt;character [1:5726]&gt;</code>\n</span>\n<span class=\"vec-data\">\"1967-065\", \"1967-080\", \"1967-096\", \"1968-042\", \"1968-092\", \"1969-062\", \"1970-012\", \"1970-070\", …</span>\n</li>\n<li>\n<span>\nJD\n<code class=\"vec-header\">&lt;double [1:5726]&gt;</code>\n</span>\n<span class=\"vec-data\">2439671.38, 2439725.7, 2439774.83, 2439999.69, 2440152.69, 2440425.69, 2440628.86, 2440832.86, …</span>\n</li>\n<li>\n<span>\nlaunch_date\n<code class=\"vec-header\">&lt;double [1:5726]&gt;</code>\n</span>\n<span class=\"vec-data\">1967-06-29, 1967-08-23, 1967-10-11, 1968-05-23, 1968-10-23, 1969-07-23, 1970-02-11, 1970-09-03, …</span>\n</li>\n<li>\n<span>\nlaunch_year\n<code class=\"vec-header\">&lt;double [1:5726]&gt;</code>\n</span>\n<span class=\"vec-data\">1967, 1967, 1967, 1968, 1968, 1969, 1970, 1970, …</span>\n</li>\n<li>\n<span>\ntype\n<code class=\"vec-header\">&lt;character [1:5726]&gt;</code>\n</span>\n<span class=\"vec-data\">\"Thor Burner 2\", \"Thor Burner 2\", \"Thor Burner 2\", \"Thor Burner 2\", \"Thor Burner 2\", \"Thor Burner 2\", \"Thor Burner 2\", \"Thor Burner 2\", …</span>\n</li>\n<li>\n<span>\nvariant\n<code class=\"vec-header\">&lt;character [1:5726]&gt;</code>\n</span>\n<span class=\"vec-data\"><em>NA</em>, <em>NA</em>, <em>NA</em>, <em>NA</em>, <em>NA</em>, <em>NA</em>, <em>NA</em>, <em>NA</em>, …</span>\n</li>\n<li>\n<span>\nmission\n<code class=\"vec-header\">&lt;character [1:5726]&gt;</code>\n</span>\n<span class=\"vec-data\">\"Secor Type II S…\", \"DAPP 3419\", \"DAPP 4417\", \"DAPP 5420\", \"DAPP 6422\", \"DAPP 7421\", \"DAPP Block 5A F…\", \"DAPP Block 5A F…\", …</span>\n</li>\n<li>\n<span>\nagency\n<code class=\"vec-header\">&lt;character [1:5726]&gt;</code>\n</span>\n<span class=\"vec-data\">\"US\", \"US\", \"US\", \"US\", \"US\", \"US\", \"US\", \"US\", …</span>\n</li>\n<li>\n<span>\nstate_code\n<code class=\"vec-header\">&lt;character [1:5726]&gt;</code>\n</span>\n<span class=\"vec-data\">\"US\", \"US\", \"US\", \"US\", \"US\", \"US\", \"US\", \"US\", …</span>\n</li>\n<li>\n<span>\ncategory\n<code class=\"vec-header\">&lt;character [1:5726]&gt;</code>\n</span>\n<span class=\"vec-data\">\"O\", \"O\", \"O\", \"O\", \"O\", \"O\", \"O\", \"O\", …</span>\n</li>\n<li>\n<span>\nagency_type\n<code class=\"vec-header\">&lt;character [1:5726]&gt;</code>\n</span>\n<span class=\"vec-data\">\"state\", \"state\", \"state\", \"state\", \"state\", \"state\", \"state\", \"state\", …</span>\n</li>\n</ul>\n</details>\n</li>\n</ul>\n</details>\n</li>\n</ul>\n```\n\n:::\n:::\n\n\nThe `data` and reactive `ds_title` are returned from the server function. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\n    return( \n        list(\n          data = data,\n          'ds_title' = reactive(input$ds_title)\n        )\n      ) \n```\n:::\n\n\n## Table display\n\n![Table view of selected #tidytuesday data](img/mod_table.png)\n\nThe second tab in the application contains a table display of the selected data from the sidebar. The input is collected from the `mod_input` (just like the list display above). By default, the tab loads with the first element in the list.\n\n\n::: {.cell layout-align=\"center\"}\n\n```\n█─launch_app \n├─█─app_ui \n│ ├─█─mod_input_ui \n│ └─█─mod_table_ui \n└─█─app_server \n  ├─█─mod_input_server \n  │ └─█─load_tt_data \n  └─█─mod_table_server \n```\n:::\n\n\nThe reactive list is returned from `mod_input_server()` as `selected_data` and passed to `mod_table_server()` in `app_server()`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\n# initialize modules\ntitle_input <- mod_input_server(\"input\")\n# return the data and title\nselected_data <- title_input$data\n# reactive values for table\nmod_table_server(id = \"table\", data = selected_data)\n```\n:::\n\n\nInside `mod_table_server()`, the reactive `data()` is renamed `ds_list` and the selected dataset (`input$ds_input`) is subsetted from the list:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\ntryCatch({\n    req(data())\n    if (length(data()) == 0) {\n      logr_msg(\n        message = \"No data available for table rendering\",\n        level = \"WARN\")\n      return(NULL)\n    }\n    ds_list <- data() #<1>\n\n    ds_selected <- as.character(input$ds_input) #<2>\n    display_ds <- ds_list[[ds_selected]]  #<3>\n}, error = function(e) {\n  logr_msg(\n    message = paste(\"Error rendering table:\", e$message),\n    level = \"ERROR\")\n    # return empty reactable with error message\n    reactable::reactable(\n      data.frame(Error = paste(\"Failed to load data:\", e$message)),\n      searchable = FALSE,\n      sortable = FALSE,\n      pagination = FALSE)\n})\n```\n:::\n\n1. Rename `data()` reactive     \n2. Selected dataset from UI input        \n3. Subset single dataset from list      \n\nThe single dataset (`display_ds`) is passed through conditional logic to ensure large datasets aren't rendered in the application:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\n# limit to first 1000 rows\ndisplay_ds <- if (nrow(display_ds) > 1000) {\n  logr_msg(\n    message = \"Large dataset detected - limiting to first 1000 rows\",\n    level = \"INFO\")\n  head(display_ds, 1000)\n} else {\n  display_ds\n}\n```\n:::\n\n\nAnd the table is passed to the `renderReactable()` function with the following table settings: \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\" code-summary=\"show/hide reactable code\"}\nreactable::reactable(\n            ttd[[1]], #<1>\n            searchable = TRUE,\n            sortable = TRUE,\n            pagination = TRUE,\n            defaultPageSize = 10,\n            showPageSizeOptions = TRUE,\n            pageSizeOptions = c(5, 10, 20, 50),\n            highlight = TRUE,\n            bordered = TRUE,\n            striped = TRUE,\n            resizable = TRUE,\n            wrap = FALSE,\n            defaultColDef = reactable::colDef(\n              minWidth = 100,\n              headerStyle = list(background = \"#f7f7f8\")\n            )\n          )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-3d24e2d7bd58eca8fa12\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-3d24e2d7bd58eca8fa12\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"agency\":[\"RVSN\",\"UNKS\",\"NASA\",\"USAF\",\"AE\",\"AFSC\",\"VKSR\",\"CALT\",\"FKA\",\"SAST\",\"ILSK\",\"KVR\",\"ULAL\",\"KHRU\",\"SPX\",\"ISRO\",\"MDSSC\",\"OSC\",\"ULAB\",\"BLS\",\"RVSNR\",\"LMA\",\"NASDA\",\"ISAS\",\"MHI\",\"ILSL\",\"UNKSR\",\"RAKA\",\"VVKO\",\"SEALP\",\"10ADS\",\"2SLS\",\"STSM\",\"USN\",\"EUROK\",\"GDCLS\",\"ESA\",\"AFSPC\",\"CNES\",\"ISA\",\"MVS\",\"CRA\",\"IRSA\",\"JAXA\",\"S4300\",\"MMCLS\",\"ABMA\",\"AFMC\",\"ELUS\",\"CASC\",\"KCST\",\"MMA\",\"PLA2AC\",\"PU\",\"SEALC\",\"SIS\",\"USA\",\"ELDO\",\"KARI\",\"RSC\",\"VMFR\",\"3SLS\",\"4SLS\",\"AEB\",\"OATK\",\"RAE\",\"RLABU\",\"CASIC4A\",\"EER\",\"EXPACE\",\"LMSC\",\"NADA\",\"RKA\",\"S394I\"],\"count\":[1528,904,469,388,258,247,200,181,128,105,97,78,70,67,65,64,62,60,58,56,54,43,37,33,33,31,29,27,27,26,22,20,20,15,14,14,13,11,11,10,10,9,8,8,8,7,6,6,6,4,4,4,4,4,4,4,4,3,3,3,3,2,2,2,2,2,2,1,1,1,1,1,1,1],\"ucode\":[\"RVSN\",\"GUKOS\",\"NASA\",\"USAF\",\"AE\",\"AFSC\",\"GUKOS\",\"CALT\",\"MOM\",\"SBA\",\"ILSK\",\"GUKOS\",\"ULAL\",\"KHRU\",\"SPX\",\"ISRO\",\"MDSSC\",\"OSC\",\"ULAB\",\"BLS\",\"RVSN\",\"MARTD\",\"NASDA\",\"ISAS\",\"MHI\",\"GDCLS\",\"GUKOS\",\"MOM\",\"GUKOS\",\"SEALP\",\"10ADS\",\"2SLS\",\"STSM\",\"USN\",\"EUROK\",\"GDCLS\",\"ESA\",\"AFSPC\",\"CNES\",\"ISA\",\"MVS\",\"CRA\",\"IRSA\",\"NASDA\",\"S4300\",\"GDCLS\",\"ABMA\",\"AFAMC\",\"BOSL\",\"CASC\",\"KCST\",\"MMA\",\"PLA2AC\",\"PU\",\"SEALP\",\"SIS\",\"USA\",\"ELDO\",\"KARI\",\"RSC\",\"VMF\",\"3SLS\",\"4SLS\",\"AEB\",\"OATK\",\"RAE\",\"RLABU\",\"CASIC4A\",\"EER\",\"EXPACE\",\"LMSC\",\"KCST\",\"MOM\",\"S394I\"],\"state_code\":[\"SU\",\"SU\",\"US\",\"US\",\"F\",\"US\",\"RU\",\"CN\",\"RU\",\"CN\",\"RU\",\"RU\",\"US\",\"RU\",\"US\",\"IN\",\"US\",\"US\",\"US\",\"US\",\"RU\",\"US\",\"J\",\"J\",\"J\",\"US\",\"RU\",\"RU\",\"RU\",\"US\",\"US\",\"US\",\"F\",\"US\",\"RU\",\"US\",\"I-ESA\",\"US\",\"F\",\"IL\",\"SU\",\"I\",\"IR\",\"J\",\"US\",\"US\",\"US\",\"US\",\"US\",\"CN\",\"KP\",\"US\",\"CN\",\"RU\",\"CYM\",\"RU\",\"US\",\"I-ELDO\",\"KR\",\"J\",\"RU\",\"US\",\"US\",\"BR\",\"US\",\"UK\",\"US\",\"CN\",\"US\",\"CN\",\"US\",\"KP\",\"RU\",\"US\"],\"type\":[\"O/LA\",\"O/LA\",\"O/LA/LV/PL/S\",\"O/LA/S\",\"O/LA\",\"LA\",\"O/LA\",\"LA/LV/PL/E\",\"O/LA\",\"O/LA/LV/PL\",\"LA\",\"O/LA\",\"LA\",\"O/LA/LV/PL/S\",\"O/LA/LV/PL/S\",\"O/LA/LV/PL/E/S\",\"LA\",\"O/LA/LV\",\"LA\",\"O/LA\",\"LA\",\"LA/LV/PL\",\"O/LA/LV/PL/E/S\",\"O/LA/LV/PL/E/S\",\"LA/PL/E\",\"LA\",\"O/LA\",\"LA\",\"LA\",\"LA\",\"LA\",\"LA\",\"O/LA\",\"O/LA/LV/E/S\",\"O\",\"LA\",\"O/LA/S\",\"O/LA\",\"O/LA/LV/PL/S\",\"O/LA\",\"LA\",\"LA/PL/S\",\"O/LA/PL/S\",\"O/LA/LV/PL/E/S\",\"LA\",\"LA\",\"O/LA/LV/PL/E\",\"LA\",\"LA\",\"O/LA/PL\",\"-\",\"LA\",\"LA\",\"LA\",\"LA\",\"LA\",\"O/LA/S\",\"O/LA/LV\",\"O/LA/LV/PL/E/S\",\"LA\",\"O/LA\",\"LA\",\"LA\",\"O/LA/S\",\"-\",\"O/LA/LV/PL/S\",\"E\",\"LV\",\"O/LA\",\"-\",\"LA/LV/PL/S\",\"LA\",\"O/LA\",\"LA\"],\"class\":[\"D\",\"D\",\"C\",\"D\",\"B\",\"D\",\"D\",\"C\",\"C\",\"B\",\"B\",\"D\",\"B\",\"B\",\"B\",\"C\",\"B\",\"B\",\"B\",\"B\",\"D\",\"B\",\"C\",\"C\",\"B\",\"B\",\"D\",\"C\",\"D\",\"B\",\"D\",\"D\",\"B\",\"D\",\"B\",\"B\",\"C\",\"D\",\"C\",\"C\",\"D\",\"C\",\"D\",\"C\",\"D\",\"B\",\"D\",\"D\",\"B\",\"B\",\"D\",\"B\",\"D\",\"B\",\"B\",\"B\",\"D\",\"C\",\"C\",\"B\",\"D\",\"D\",\"D\",\"C\",\"B\",\"D\",\"B\",\"C\",\"B\",\"B\",\"B\",\"D\",\"C\",\"D\"],\"tstart\":[\"1960\",\"1986 Apr 24\",\"1958 Oct  1\",\"1947 Sep 18\",\"1980 Mar 26\",\"1961 Apr  1\",\"1997 Jul\",\"1957 Nov 11\",\"2004\",\"1993\",\"1995\",\"2001 Jun  1\",\"2006 Dec\",\"1994\",\"2007 Aug\",\"1969\",\"-\",\"1986\",\"2006 Dec\",\"1990s\",\"1991 Dec\",\"1995 Mar 15\",\"1969 Oct\",\"1964 Apr\",\"1964\",\"2000\",\"1991\",\"1999\",\"2011 Dec  1\",\"2000 Sep\",\"1966?\",\"1990s\",\"1996 Aug  6\",\"1775\",\"1995\",\"1988\",\"1975 Apr 30\",\"1982 Sep  1\",\"1962\",\"1983\",\"1946 Mar\",\"1959\",\"2004\",\"2003 Oct  1\",\"-\",\"1994 May\",\"1956 Feb\",\"1992 Jul  1\",\"2010\",\"1999 Jul\",\"1998?\",\"1961\",\"1966 Jul  1\",\"1992?\",\"1997\",\"2005?\",\"1775 Jun 14\",\"1962?\",\"1989 Oct\",\"1990 Jul  5\",\"1991 Dec\",\"1990s\",\"1990s\",\"-\",\"2015 Feb 10\",\"1918 Apr  1\",\"2014\",\"2002\",\"1990 Dec\",\"2016\",\"1961 Jun\",\"2013\",\"1992 Feb\",\"-\"],\"tstop\":[\"1991 Dec\",\"1991\",\"-\",\"-\",\"*\",\"1992 Jul  1\",\"2001 Jun  1\",\"-\",\"2016 Jan  1\",\"-\",\"-\",\"2011 Dec  1\",\"-\",\"1998\",\"-\",\"-\",\"-\",\"1993\",\"-\",\"*\",\"-\",\"2003 Jan\",\"2003 Oct  1\",\"1981 Apr\",\"-\",\"2008\",\"1992\",\"2004\",\"2015\",\"2010\",\"-\",\"*\",\"*\",\"-\",\"-\",\"1994 May\",\"-\",\"-\",\"-\",\"-\",\"1950 Feb\",\"-\",\"-\",\"-\",\"-\",\"1995 Mar 15\",\"1961 Dec\",\"-\",\"-\",\"-\",\"2013\",\"1995 Mar 15\",\"2016 Jan  1\",\"-\",\"2000 Sep\",\"-\",\"*\",\"1975\",\"-\",\"2006 Mar 31\",\"-\",\"*\",\"*\",\"*\",\"-\",\"1991 Apr  1\",\"-\",\"-\",\"2001?\",\"-\",\"1995 Mar 15\",\"-\",\"1999\",\"-\"],\"short_name\":[\"RVSN\",\"UNKS\",\"NASA\",\"USAF\",\"Arianespace\",\"AFSC\",\"VKS RVSN\",\"CALT\",\"Roskosmos\",\"SAST\",\"ILS-K\",\"KVR\",\"ULA/LMA\",\"Khrunichev\",\"SpaceX\",\"ISRO\",\"MDSSC\",\"OSC-Fairfax\",\"ULA/Boeing\",\"Boeing\",\"RVSN RF\",\"LMA\",\"NASDA\",\"ISAS\",\"MHI\",\"ILS-LMA\",\"UNKS RF\",\"RAKA\",\"VVKO\",\"SeaLaunch\",\"ADCOM 10ADS\",\"Boeing/2SLS\",\"Starsem\",\"USN\",\"Eurockot\",\"GDCLS\",\"ESA\",\"USAF AFSPC\",\"CNES\",\"ISA\",\"MVS\",\"CRA\",\"IRSA\",\"JAXA\",\"SAC 4300SS\",\"MMCLS\",\"ABMA\",\"USAF AFMC\",\"Energia Ltd US\",\"CASC\",\"KCST\",\"MMA\",\"PLA SAC\",\"PU\",\"SeaLaunch\",\"SIS\",\"US Army\",\"CECLES/ELDO\",\"KARI\",\"RSC\",\"VMF RF\",\"USAF 3SLS\",\"USAF 4SLS\",\"AEB\",\"OATK\",\"RAE\",\"Rocket Lab\",\"CASIC 4th Acad\",\"EER\",\"CASIC Expace\",\"LMSC\",\"NADA\",\"RKA\",\"SAC 394ITMS\"],\"name\":[\"Rakentiye Voiska Strategicheskogo Naznacheniye\",\"Upravleniye Nachalnika Kosmicheskikh Sredstv\",\"National Aeronautics and Space Administration\",\"United States Air Force\",\"Arianespace, Inc.\",\"US Air Force Systems Command, Los Angeles AFS\",\"Voenno-Kosmicheskiye Sili (Military Space Forces), RVSN\",\"Zhongguo yunzaihuojian jishu yanjiu yuan\",\"Federal'noe kosmicheskoe agentstvo Rossii (Roskosmos)\",\"Shanghai hangtian jishu yanjiuyuan\",\"International Launch Services, Khrunichev\",\"Kosmichesikiye voyska Rossii\",\"United Launch Alliance/Lockheed Martin Astronautics\",\"GKNPTs im. M.V. Khrunichev, Zavod Khrunichev\",\"SpaceX\",\"Indian Space Research Organization\",\"McDonnell Douglas Space Systems Corp. (MDSSC-HB)\",\"Orbital Sciences Corp.\",\"United Launch Alliance/Boeing\",\"Boeing Launch Services (?)\",\"Rakentiye Voiska Strategicheskogo Naznacheniye (Rossisk. Fed.)\",\"Lockheed Martin Astronautics\",\"Ucyu Kaihatsu Jigyoudan\",\"Ucyu Koku Kenkyujyo\",\"Mitsubishi Jukogyo Kabushiki-kaisha\",\"International Launch Services, Lockheed Martin\",\"Upravleniye Nachalnika Kosmicheskikh Sredstv RF\",\"Rosaviakosmos (Rossiskoe aviatsionno-kosmicheskoe agentstvo)\",\"Voisk Vosdushno-Kosmicheskoi Oborona\",\"Sea Launch Limited Partnership\",\"USAF Aerospace Defence Command, 10th Aerospace Defence Sqn.\",\"Boeing/USAF 2SLS\",\"Starsem\",\"United States Navy\",\"Eurockot Launch Services GmbH (D for RU lanch vehicle)\",\"General Dynamics Commercial Launch Service\",\"European Space Agency\",\"US Air Force Space Command\",\"Centre Nationale d'Etudes Spatiales, Paris\",\"Israeli Space Agency\",\"Ministerstvo Voenniy Sili?\",\"Centro Richerchi Aerospaziale, Roma la Sapienza\",\"Sazman Fizaii Iran (Iranian Space Agency)\",\"Ucyu Koku Kenkyu Kaihatsu Kikou\",\"USAF Strategic Air Command, 4300th Support Sqn.\",\"Martin Marietta Commercial Launch Services\",\"U.S. Army Ballistic Missile Agency\",\"US Air Force Materiel Command\",\"Energia Logistics Ltd, (ELUS)\",\"Zhongguo hangtian keji jituangongsi\",\"Joseon ujugong gangisul wiwonhoe\",\"Martin Marietta Astronautics\",\"Di Er Paobing Budui, Zhongguo Renmin Jeifangjun\",\"ZAO Puskovie Uslugi\",\"Sea Launch Limited Partnership\",\"Space International Services\",\"United States Army\",\"Centre Europeene de Construct. de Lanceurs et d'Engins Spatiaux\",\"Han-guk Hanggong Uju Yeon-guwon (Korea Aerospace Research Inst)\",\"Rocket Systems Corporation\",\"Voenno-Morskoy Flot RF\",\"USAF 3SLS\",\"USAF 4SLS\",\"Agencia Espacial Brasileira\",\"Orbital ATK\",\"Royal Aircraft Establishment\",\"Rocket Lab USA\",\"Zhongguo hangtian kegong jituan di 4 yanjiuyuan\",\"EER Systems Inc. Aerospace Div.\",\"Hangtian kegong huojian jishu youxiangongsi\",\"Lockheed Missiles and Space Co.\",\"Gugga Uju Gaebalgug (Kukga uju gaebalkuk)\",\"Rossiskoe aviatsionno-kosmicheskoe agentsvo (Rosaviakosmos)\",\"USAF Strategic Air Command, 394th ICBM Test Maintenance Sqn\"],\"location\":[\"Mosvka?\",\"Moskva\",\"Washington, D.C.\",\"Washington, DC-Pentagon\",\"Paris-Evry, France\",\"El Segundo, California\",\"Mosvka-Solnechnogorsk, Rossiya\",\"Beijing-Nanyuan\",\"Moskva\",\"Shanghai-Minghan\",\"Moskva\",\"Moskva-Solnechnogorsk\",\"Denver-Centennial, Colorado\",\"Moskva-Fili\",\"Hawthorne, California\",\"Bangalore\",\"Huntington Beach, California\",\"Fairfax, Virginia\",\"Denver-Centennial, Colorado\",\"Huntington Beach, California\",\"Mosvka?\",\"Denver-Littleton, Colorado\",\"Tokyo, Nippon\",\"Tokyo-Komaba\",\"Tokyo-Minato\",\"McLean, Virginia\",\"Moskva\",\"Moskva, Rossiya\",\"Moskva\",\"Long Beach, California\",\"Vandenberg AFB, California\",\"Patrick AFB, Florida\",\"Paris-Evry\",\"Washington, DC-Pentagon\",\"Bremen\",\"San Diego, California\",\"Paris\",\"Peterson AFB, Colorado\",\"Paris\",\"Yisra'el\",\"Moskva\",\"Roma\",\"Tehran\",\"Tokyo-Chofu\",\"Vandenberg AFB, California\",\"San Diego, California\",\"Huntsville, Alabama\",\"Wright-Patterson AFB, Dayton, Ohio\",\"Long Beach, California\",\"Beijing, Zhongguo\",\"Pyongyang?\",\"Denver, Colorado\",\"Beijing\",\"Moskva\",\"Georgetown, Cayman Islands\",\"Moskva\",\"Washington, DC\",\"Paris\",\"Daejeon\",\"Tokyo\",\"Moskva, Rossiya\",\"Patrick AFB, Florida\",\"Patrick AFB, Florida\",\"San Jose dos Campos, Brasil\",\"Washington-Dulles, Virginia\",\"Farnborough, Hants.\",\"Los Angeles, California\",\"Beijing?\",\"Seabrook, Maryland\",\"Beijing-Haidian\",\"Sunnyvale, California\",\"Pyongyang\",\"Moskva\",\"Vandenberg AFB, California\"],\"longitude\":[\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\"],\"latitude\":[\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\"],\"error\":[\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\"],\"parent\":[\"-\",\"MO\",\"-\",\"-\",\"-\",\"USAF\",\"RVSN\",\"CASC\",\"-\",\"CASC\",\"KHRU\",\"-\",\"LM\",\"-\",\"-\",\"-\",\"MDC\",\"-\",\"BOE\",\"BOHB\",\"-\",\"LM\",\"-\",\"-\",\"-\",\"LM\",\"RVSNR\",\"-\",\"-\",\"-\",\"AFADC\",\"USAF\",\"-\",\"-\",\"-\",\"GD\",\"-\",\"USAF\",\"-\",\"IL\",\"-\",\"CRPSM\",\"-\",\"-\",\"USAF\",\"MM\",\"USA\",\"USAF\",\"RKKE\",\"-\",\"-\",\"MM\",\"-\",\"-\",\"-\",\"-\",\"-\",\"I-ELDO\",\"-\",\"-\",\"-\",\"USAF\",\"USAF\",\"BR\",\"-\",\"-\",\"-\",\"CASIC\",\"-\",\"CASIC\",\"LAC\",\"-\",\"-\",\"USAF\"],\"short_english_name\":[\"-\",\"-\",\"-\",\"-\",\"Arianespace\",\"-\",\"-\",\"CALT\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"USAF AFMC\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"BSA\",\"-\",\"-\",\"-\",\"-\",\"-\",\"Expace\",\"-\",\"-\",\"-\",\"-\"],\"english_name\":[\"Strategic Rocket Forces\",\"-\",\"-\",\"-\",\"-\",\"-\",\"Russian Military Space Forces\",\"Chinese Academy of Launch Vehicle Technology (CASC 1st Acad)\",\"Roskosmos\",\"Shanghai Academy of Space Technology (CASC 8th Acad)\",\"-\",\"Russian Space Forces\",\"-\",\"Khrunichev State Research and Production Center\",\"-\",\"-\",\"McDonnell Douglas/HB\",\"-\",\"-\",\"-\",\"Russian Strategic Rocket Forces\",\"-\",\"National Space Development Adminstration\",\"Institute of Space and Aeronautical Sci\",\"Mitsubishi Heavy Industries (Launch Services)\",\"-\",\"-\",\"-\",\"Aerospace Defence Forces\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"National Space Research Center\",\"-\",\"Miinistry of the Armed Forces\",\"Aerospace Research Center\",\"Iranian Space Agency\",\"Japan Aerospace Exploration Agency\",\"-\",\"-\",\"-\",\"-\",\"-\",\"China Aerospace Corp\",\"Korean Committee of Space Technology\",\"-\",\"PLA Second Artillery Corps\",\"-\",\"-\",\"-\",\"-\",\"European Launcher Development Organization\",\"Korea Aerospace Research Institute\",\"-\",\"Russian Navy\",\"-\",\"-\",\"Brazilian Space Agency\",\"-\",\"-\",\"-\",\"CASIC 4th Academy\",\"-\",\"Expace\",\"-\",\"National Aerospace Development Administration\",\"-\",\"-\"],\"unicode_name\":[\"Ракетные войска стратегического назначения\",\"Управление начальника космических средств МО СССР\",\"National Aeronautics and Space Administration\",\"United States Air Force\",\"Arianespace, Inc.\",\"US Air Force Systems Command, Los Angeles AFS\",\"Военно-космические силы РВСН\",\"中国运载火箭技术研究院\",\"Федеральное космическое агентство (Роскосмос)\",\"上海航天技术研究院\",\"International Launch Services, Khrunichev\",\"Космические войска России\",\"United Launch Alliance/Lockheed Martin Astronautics\",\"ГКНПЦ им. М.В.Хруничева\",\"SpaceX\",\"Indian Space Research Organization\",\"McDonnell Douglas Space Systems Corp. (MDSSC-HB)\",\"Orbital Sciences Corp.\",\"United Launch Alliance/Boeing\",\"Boeing Launch Services (?)\",\"Ракетные войска стратегического назначения Российской Федерации\",\"Lockheed Martin Astronautics\",\"宇宙開発事業団\",\"宇宙航空研究所\",\"三菱重工業株式会社\",\"International Launch Services, Lockheed Martin\",\"Управление начальника космических средств\",\"Российское авиационно-космическое агентство\",\"Войска воздушно-космической обороны\",\"Sea Launch Limited Partnership\",\"USAF Aerospace Defence Command, 10th Aerospace Defence Sqn.\",\"Boeing/USAF 2SLS\",\"Starsem\",\"United States Navy\",\"Eurockot Launch Services GmbH (D for RU lanch vehicle)\",\"General Dynamics Commercial Launch Service\",\"European Space Agency\",\"US Air Force Space Command\",\"Centre national d'études spatiales\",\"Israeli Space Agency\",\"Министерство Вооруженных Сил СССР\",\"Centro Richerchi Aerospaziale, Roma la Sapienza\",\"سازمان فضایی ایران\",\"宇宙航空研究開発機構\",\"USAF Strategic Air Command, 4300th Support Sqn.\",\"Martin Marietta Commercial Launch Services\",\"U.S. Army Ballistic Missile Agency\",\"US Air Force Materiel Command\",\"Energia Logistics Ltd, (ELUS)\",\"中国航天科技集团公司\",\"조선우주공간기술위원회\",\"Martin Marietta Astronautics\",\"第二炮兵部队\",\"ЗАО «Пусковые услуги»\",\"Sea Launch Limited Partnership\",\"Space International Services\",\"United States Army\",\"Centre européen pour la construction de lanceurs d'engins spatiaux\",\"한국항공우주연구원\",\"株)ロケットシステム\",\"Военно-Морской Флот Российской Федерации\",\"USAF 3SLS\",\"USAF 4SLS\",\"Agência Espacial Brasileira\",\"Orbital ATK\",\"Royal Aircraft Establishment\",\"Rocket Lab USA\",\"中国航天科工集团第四研究院\",\"EER Systems Inc. Aerospace Div.\",\"航天科工火箭技术有限公司\",\"Lockheed Missiles and Space Co.\",\"국가우주개발국\",\"Российское космическое агентство\",\"USAF Strategic Air Command, 394th ICBM Test Maintenance Sqn\"],\"agency_type\":[\"state\",\"state\",\"state\",\"state\",\"private\",\"state\",\"state\",\"state\",\"state\",\"state\",\"private\",\"state\",\"private\",\"state\",\"startup\",\"state\",\"private\",\"private\",\"private\",\"private\",\"state\",\"private\",\"state\",\"state\",\"private\",\"private\",\"state\",\"state\",\"state\",\"private\",\"state\",\"state\",\"private\",\"state\",\"private\",\"private\",\"state\",\"state\",\"state\",\"state\",\"state\",\"state\",\"state\",\"state\",\"state\",\"private\",\"state\",\"state\",\"private\",\"state\",\"state\",\"private\",\"state\",\"private\",\"private\",\"state\",\"state\",\"state\",\"state\",\"private\",\"state\",\"state\",\"state\",\"state\",\"private\",\"state\",\"startup\",\"state\",\"private\",\"state\",\"private\",\"state\",\"state\",\"state\"]},\"columns\":[{\"id\":\"agency\",\"name\":\"agency\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"count\",\"name\":\"count\",\"type\":\"numeric\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"ucode\",\"name\":\"ucode\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"state_code\",\"name\":\"state_code\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"type\",\"name\":\"type\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"class\",\"name\":\"class\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"tstart\",\"name\":\"tstart\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"tstop\",\"name\":\"tstop\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"short_name\",\"name\":\"short_name\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"name\",\"name\":\"name\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"location\",\"name\":\"location\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"longitude\",\"name\":\"longitude\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"latitude\",\"name\":\"latitude\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"error\",\"name\":\"error\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"parent\",\"name\":\"parent\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"short_english_name\",\"name\":\"short_english_name\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"english_name\",\"name\":\"english_name\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"unicode_name\",\"name\":\"unicode_name\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}},{\"id\":\"agency_type\",\"name\":\"agency_type\",\"type\":\"character\",\"minWidth\":100,\"headerStyle\":{\"background\":\"#f7f7f8\"}}],\"resizable\":true,\"searchable\":true,\"defaultPageSize\":10,\"showPageSizeOptions\":true,\"pageSizeOptions\":[5,10,20,50],\"highlight\":true,\"bordered\":true,\"striped\":true,\"nowrap\":true,\"dataKey\":\"0b0f73a35976b96d480c16e3549c272d\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n1. In the app, this is `display_ds`   \n\n\n## Graph display\n\n![Graphs of selected #tidytuesday dataset](img/mod_plot.png)\n\nThe third tab display graphs for the selected [#TidyTuesday data](https://github.com/rfordatascience/tidytuesday) compliments of the \n[`inspectdf` package](https://github.com/alastairrushworth/inspectdf/tree/master), which provides \"*collection of utilities for columnwise summary, comparison and visualisation of data frames.*\"\n\nThe `mod_plot` module uses the same reactive input from `mod_input` as the `mod_list` and `mod_table`:\n\n\n::: {.cell layout-align=\"center\"}\n\n```\n█─launch_app \n├─█─app_ui \n│ ├─█─mod_input_ui \n│ └─█─mod_plot_ui \n└─█─app_server \n  ├─█─mod_input_server \n  │ └─█─load_tt_data \n  └─█─mod_plot_server \n    └─█─inspect_plot \n```\n:::\n\n\nThe UI contains a dropdown input for choosing a `dataset` and checkboxes for selecting `plots`, which are rendered via `uiOutput()`:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nns <- NS(id) #<1>\ntagList(\n  selectInput( #<2>\n    ns(\"dataset\"),\n    \"Choose dataset:\",\n    choices = NULL,\n    selected = NULL\n  ), #<2>\n  checkboxGroupInput( #<3>\n    ns(\"plots\"),\n    \"Select plot type:\",\n    choices = c(\n      \"types\"       = \"types\",\n      \"memory\"      = \"mem\",\n      \"missing\"     = \"na\",\n      \"correlation\" = \"cor\",\n      \"imbalance\"   = \"imb\",\n      \"numeric\"     = \"num\",\n      \"categorical\" = \"cat\"\n    ),\n    selected = c(\"types\",\"mem\",\"na\")\n  ), #<3>\n  uiOutput(ns(\"plots_ui\"))  #<4>\n)\n```\n:::\n\n1. Namespace (for connecting modules)    \n2. Dataset input (from selected #TidyTuesday data in sidebar)    \n3. Plots selected from [`inspectdf` package](https://alastairrushworth.com/inspectdf/)     \n4. Plot outputs    \n\n![Graph inputs](img/mod_plot_inputs.png){width='75%' fig-align='center'}\n\nInside `mod_plot_server()`, I've written `inspect_plot()`, which combines the `inspect_*()` + `show_plot()` functions from `inspectdf` and returns the corresponding plot. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nobserve({\n    tryCatch({\n      ds_list <- req(ttd_r())\n      sel_ds  <- input$dataset #<1>\n      req(sel_ds %in% names(ds_list))  \n      df <- ds_list[[sel_ds]] #<2>\n      logr_msg(\n        message = sprintf(\"Rendering plots for dataset '%s'\", sel_ds),\n        level = \"INFO\")\n\n      purrr::walk(input$plots, function(plt) { #<3>\n        out_id <- paste0(\"plt_\", plt)\n        output[[out_id]] <- renderPlot({\n          tryCatch({\n            inspect_plot(\n              ttd = setNames(list(df), sel_ds),\n              plots = plt\n            )\n          }, error = function(err2) {\n            logr_msg(\n              message = sprintf(\"Error plotting %s:%s — %s\",\n                sel_ds, plt, err2$message),\n              level = \"ERROR\")\n            plot.new() #<4> \n            text(0.5, 0.5, \"Error generating plot\", cex = 1.2, col = \"red\") #<4> \n          })\n        })\n      }) #<3>\n    }, error = function(err) {\n      logr_msg(\n        message = sprintf(\"Error in plot observer: %s\", err$message),\n        level = \"ERROR\")\n    })\n  }) |>\n  bindEvent(list(input$dataset, input$plots),\n            ignoreNULL = TRUE)\n```\n:::\n\n1. Selected dataset from UI   \n2. Extract dataset from list (`ds_list`)    \n3. Iterate over plot inputs (`input$plots`)  \n4. Display placeholder    \n\n`inspect_plot()` has to be called for each plot selected with `input$plots`, so `purrr::walk()` allows us to iterate through the plots selected via the `checkboxGroupInput()` in `mod_plot_ui()`:\n\nThe output (`plots_ui`) is rendered with `renderUI()` and once again we use purrr::map() to iterate through the `input$plots` selections, create namespaces, and \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\noutput$plots_ui <- renderUI({\n  tryCatch({\n    req(input$dataset, input$plots) #<1>\n    \n    logr_msg(message =\n        sprintf(\"Rendering UI for dataset '%s' and plots: %s\",\n                 input$dataset,\n                 paste(input$plots, collapse = \", \")),\n             level = \"DEBUG\")\n\n    purrr::map(input$plots, function(plt) { #<2>\n      plot_id <- ns(paste0(\"plt_\", plt))\n      tagList(\n        h4(plt),\n        plotOutput(plot_id, height = \"300px\")\n      )\n    }) #<2>\n    \n  }, error = function(err) { #<3>\n    logr_msg(\n      message = sprintf(\"Error in plots_ui renderUI: %s\", err$message),\n      level = \"ERROR\")\n    tagList(\n      p(style = \"color:red;\", \"Failed to generate plot UI.\")\n    )\n  }) #<3>\n})\n```\n:::\n\n1. Require the `dataset` and `plots` inputs   \n2. Iterate through the selected plot types and create headers and outputs   \n3. Safely generate errors if plots fail     \n\nBy default, the application creates plots for the variable types, memory, and missing: \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\ninspect_plot(\n  ttd = list(\"agencies.csv\" = ttd[[1]]), # <1>\n  plots = c(\"types\", \"mem\", \"na\")\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/inspect_plot_ttd-1.png){fig-align='center' width=85%}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/inspect_plot_ttd-2.png){fig-align='center' width=85%}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/inspect_plot_ttd-3.png){fig-align='center' width=85%}\n:::\n\n```\n# NULL\n```\n:::\n\n1. The `ttd` argument is meant to contain a list object returned from the `load_tt_data()` function, so to plot the graphs for a single dataset we need to wrap it in a named list. \n\n## Reports\n\nThe downloadable reports need to contain everything the user can see in the application (the list display with `listviewerlite`, the `reactable` table, and the graphs generated with `inspectdf`). To accomplish this, we need to make sure each module returns the objects they render. \n\n### Report modules\n\nThere are three modules for handling the downloadable reports: `mod_report_input` collects the selected format, `mod_report_desc` displays a description of the selected format in the UI, and `mod_report_download` renders and downloads the report.\n\n\n::: {.cell layout-align=\"center\"}\n\n```\n█─launch_app \n├─█─app_ui \n│ ├─█─mod_input_ui \n│ ├─█─mod_report_input_ui \n│ ├─█─mod_report_desc_ui \n│ └─█─mod_report_download_ui \n└─█─app_server \n  ├─█─mod_input_server \n  │ └─█─load_tt_data \n  ├─█─mod_report_input_server \n  ├─█─mod_report_desc_server \n  └─█─mod_report_download_server \n```\n:::\n\n\n\n#### Report input\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n#### Report description \n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n#### Report download \n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n#### Download handler\n\n##### filename\n\n##### content\n\n#### render_report()\n\nThe `render_report()` utility function controls the template used when the download button is clicked:\n\n\n::: {.cell layout-align=\"center\"}\n\n```\n█─mod_report_server \n├─█─render_report \n│ ├─█─get_template_path \n│ ├─█─create_fallback_template \n│ │ ├─█─create_fallback_rmd_template \n│ │ └─█─create_fallback_qmd_template \n│ ├─█─render_rmarkdown_report \n│ └─█─render_quarto_report \n└─█─create_error_report \n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n#### Templates \n\nWe'll store the report templates in the `inst/` folder. Anything in `inst/` automatically included and accessible from an installed application with `system.file()`, so it's a great place for template files. \n\nThe templates are accessed with the `get_template_path()` function. The `get_template_path()` function returns the installed location of our templates: \n\n\n```{.default}\n└── inst\n    └── rmarkdown\n        └── report_template.Rmd\n```\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nidentical(\n  # response from function\n  x = get_template_path('rmarkdown'), \n  # response from system.file()\n  y = system.file(\"rmarkdown\", \"report_template.Rmd\", \n                  package = \"ttdviewer\"))\n#  [1] TRUE\n```\n:::\n\n\n\n```{.default}\n└── inst\n    └── quarto\n        └── report_template.qmd\n```\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nidentical(\n  # response from function\n  x = get_template_path('quarto'), \n  # response from system.file()\n  y = system.file(\"quarto\", \"report_template.qmd\", \n                  package = \"ttdviewer\"))\n#  [1] TRUE\n```\n:::\n\n\n#### Fallback templates \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nrmd_temp <- create_fallback_template(format = \"rmarkdown\")\nbasename(rmd_temp)\n#  [1] \"file4f125a69628c.Rmd\"\n```\n:::\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nqmd_temp <- create_fallback_template(format = \"quarto\")\nbasename(qmd_temp)\n#  [1] \"file4f1227ef5f57.qmd\"\n```\n:::\n\n\n\n### Reactives and params\n\n### R Markdown params\n\n### Quarto params\n\n\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/tree-views-0.1.0/tree-views.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/core-js-2.5.3/shim.min.js\"></script>\n<script src=\"../../site_libs/react-18.2.0/react.min.js\"></script>\n<script src=\"../../site_libs/react-18.2.0/react-dom.min.js\"></script>\n<script src=\"../../site_libs/reactwidget-2.0.0/react-tools.js\"></script>\n<link href=\"../../site_libs/htmltools-fill-0.5.9/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/reactable-0.4.5/reactable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/reactable-binding-0.4.5/reactable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}